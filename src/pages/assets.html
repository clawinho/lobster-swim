<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ü¶û Lobster Swim - Asset Library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background: linear-gradient(180deg, #000810 0%, #001020 50%, #001830 100%); min-height: 100vh; font-family: monospace; color: #fff; padding: 20px; }
        header { text-align: center; padding: 30px 0; border-bottom: 1px solid #ff450044; margin-bottom: 30px; }
        header h1 { color: #ff4500; font-size: 2.5em; margin-bottom: 10px; }
        header p { color: #666; font-size: 0.9em; }
        #compare-panel { display: none; background: #001020; border: 2px solid #ff4500; border-radius: 12px; padding: 20px; margin-bottom: 30px; position: relative; }
        #compare-panel.active { display: block; }
        #compare-panel h3 { color: #ff4500; margin-bottom: 15px; }
        #compare-close { position: absolute; top: 15px; right: 15px; background: #ff450033; border: 1px solid #ff4500; color: #ff4500; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; }
        #compare-grid { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; }
        .compare-item { background: #000810; border: 1px solid #ff450044; border-radius: 8px; padding: 15px; text-align: center; min-width: 200px; }
        .compare-item .label { color: #ff4500; font-weight: bold; margin: 10px 0 5px; }
        .compare-item .desc { color: #888; font-size: 0.8em; }
        .nav { display: flex; justify-content: center; gap: 15px; margin-bottom: 40px; flex-wrap: wrap; }
        .nav a { color: #888; text-decoration: none; padding: 8px 16px; border: 1px solid #333; border-radius: 4px; }
        .nav a:hover, .nav a.active { color: #ff4500; border-color: #ff4500; background: #ff450011; }
        .section { display: none; margin-bottom: 50px; }
        .section.active { display: block; }
        .section h2 { color: #ff4500; font-size: 1.4em; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ff450033; }
        .asset-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
        .asset-card { background: #001020; border: 1px solid #ff450033; border-radius: 8px; overflow: hidden; }
        .asset-card:hover { border-color: #ff4500; }
        .asset-preview { background: #000810; height: 180px; display: flex; align-items: center; justify-content: center; }
        .asset-info { padding: 15px; }
        .asset-info h3 { color: #fff; margin-bottom: 8px; }
        .asset-info p { color: #888; font-size: 0.85em; margin-bottom: 12px; }
        .asset-meta { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 12px; }
        .tag { font-size: 0.7em; padding: 3px 8px; border-radius: 3px; background: #ff450022; color: #ff4500; }
        .tag.level { background: #4488ff22; color: #4488ff; }
        .controls { display: flex; flex-direction: column; gap: 8px; }
        .control-row { display: flex; align-items: center; gap: 10px; }
        .control-row label { color: #666; font-size: 0.75em; width: 70px; }
        .control-row input[type="range"] { flex: 1; accent-color: #ff4500; }
        .control-row .value { color: #ff4500; font-size: 0.8em; width: 40px; text-align: right; }
        .version-history { display: flex; gap: 8px; margin-top: 12px; padding-top: 12px; border-top: 1px solid #ffffff11; flex-wrap: wrap; }
        .version { font-size: 0.7em; padding: 4px 8px; border-radius: 3px; background: #222; color: #666; cursor: pointer; border: 1px solid transparent; }
        .version:hover { background: #333; }
        .version.current { background: #ff450033; color: #ff4500; }
        .version.in-compare { border-color: #00ff88; background: #00ff8822; color: #00ff88; }
        #bottom-nav { position: fixed; bottom: 15px; right: 20px; display: flex; gap: 10px; }
        #bottom-nav a { color: #4488ff; text-decoration: none; background: #001828; border: 1px solid #4488ff44; padding: 8px 14px; border-radius: 4px; }
        #bottom-nav a.game { color: #ff4500; border-color: #ff450044; }
        #toast { position: fixed; bottom: 70px; right: 20px; background: #00ff8833; border: 1px solid #00ff88; color: #00ff88; padding: 10px 20px; border-radius: 6px; opacity: 0; transition: opacity 0.3s; }
        #toast.show { opacity: 1; }
        .audio-btn { background: #ff4500; border: none; color: #000; padding: 8px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; font-size: 14px; }
        .audio-btn:hover { background: #ff6633; transform: scale(1.05); }
    </style>
</head>
<body>
    <header><h1>ü¶û Asset Library</h1><p>Modular entity versions ‚Äî click tags to compare</p></header>
    <div id="compare-panel"><h3>üî¨ Comparison</h3><button id="compare-close" onclick="clearComparison()">√ó</button><div id="compare-grid"></div></div>
    
    <nav class="nav">
        <a href="#characters" class="active">Characters</a>
        <a href="#enemies">Enemies</a>
        <a href="#items">Items</a>
        <a href="#environments">Environments</a>
        <a href="#mechanics">Mechanics</a>
        <a href="#audio">Audio</a>
    </nav>
    
    <section class="section active" id="characters">
        <h2>ü¶û Characters</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview"><canvas id="lobster-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Lobster</h3><p>Player character with tail physics.</p>
                    <div class="controls">
                        <div class="control-row"><label>Size</label><input type="range" id="lobster-size" min="15" max="60" value="30"><span class="value">30</span></div>
                        <div class="control-row"><label>Tail wag</label><input type="range" id="lobster-wag" min="1" max="20" value="8"><span class="value">8</span></div>
                    </div>
                    <div class="version-history">
                        <span class="version" data-asset="lobster" data-version="001" data-desc="Basic circle">v001</span>
                        <span class="version" data-asset="lobster" data-version="002" data-desc="With claws">v002</span>
                        <span class="version current" data-asset="lobster" data-version="003" data-desc="Tail physics">v003 ‚òÖ</span>
                    </div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="fish-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Golden Fish</h3><p>+1 life pickup. v002 has shimmer!</p>
                    <div class="controls">
                        <div class="control-row"><label>Shimmer</label><input type="range" id="fish-shimmer" min="0" max="10" value="5"><span class="value">5</span></div>
                    </div>
                    <div class="version-history">
                        <span class="version current" data-asset="fish" data-version="001" data-desc="Simple gold">v001 ‚òÖ</span>
                        <span class="version" data-asset="fish" data-version="002" data-desc="Shimmer particles">v002</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="enemies">
        <h2>üíÄ Enemies</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview"><canvas id="hook-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Hook</h3><p>Pendulum swing hazard.</p>
                    <div class="controls">
                        <div class="control-row"><label>Swing</label><input type="range" id="hook-swing" min="1" max="20" value="10"><span class="value">10</span></div>
                        <div class="control-row"><label>Line</label><input type="range" id="hook-line" min="50" max="150" value="100"><span class="value">100</span></div>
                    </div>
                    <div class="version-history">
                        <span class="version" data-asset="hook" data-version="001" data-desc="Static">v001</span>
                        <span class="version current" data-asset="hook" data-version="002" data-desc="Pendulum">v002 ‚òÖ</span>
                    </div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="cage-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Cage</h3><p>Lobster trap.</p>
                    <div class="controls">
                        <div class="control-row"><label>Size</label><input type="range" id="cage-size" min="30" max="80" value="50"><span class="value">50</span></div>
                    </div>
                    <div class="version-history">
                        <span class="version" data-asset="cage" data-version="001" data-desc="Purple void">v001</span>
                        <span class="version current" data-asset="cage" data-version="002" data-desc="Wooden trap">v002 ‚òÖ</span>
                    </div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="net-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Net</h3><p>Level 2 sweeping hazard.</p>
                    <div class="controls">
                        <div class="control-row"><label>Width</label><input type="range" id="net-width" min="40" max="120" value="80"><span class="value">80</span></div>
                    </div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="fork-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Fork</h3><p>Level 3 falling hazard.</p>
                    <div class="controls">
                        <div class="control-row"><label>Size</label><input type="range" id="fork-size" min="20" max="60" value="40"><span class="value">40</span></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="items">
        <h2>‚ú® Items</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview"><canvas id="bubble-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Bubble</h3><p>Collectible. v002 has gradient!</p>
                    <div class="controls">
                        <div class="control-row"><label>Size</label><input type="range" id="bubble-size" min="10" max="30" value="18"><span class="value">18</span></div>
                    </div>
                    <div class="version-history">
                        <span class="version current" data-asset="bubble" data-version="001" data-desc="Simple">v001 ‚òÖ</span>
                        <span class="version" data-asset="bubble" data-version="002" data-desc="Gradient wobble">v002</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="environments">
        <h2>üåä Environments</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview"><canvas id="ocean-bg" width="200" height="150"></canvas></div>
                <div class="asset-info"><h3>Ocean</h3><p>Level 1</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="tank-bg" width="200" height="150"></canvas></div>
                <div class="asset-info"><h3>Tank</h3><p>Level 2</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="kitchen-bg" width="200" height="150"></canvas></div>
                <div class="asset-info"><h3>Kitchen</h3><p>Level 3</p></div>
            </div>
        </div>
    </section>

    
    <section class="section" id="mechanics">
        <h2>‚öôÔ∏è Mechanics</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview"><canvas id="magnet-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Bubble Magnetism</h3>
                    <p>Bubbles attracted to lobster within radius.</p>
                    <div class="controls">
                        <div class="control-row"><label>Radius</label><input type="range" id="magnet-radius" min="30" max="150" value="80"><span class="value">80</span></div>
                        <div class="control-row"><label>Strength</label><input type="range" id="magnet-strength" min="1" max="10" value="3"><span class="value">3</span></div>
                    </div>
                    <div class="asset-meta"><span class="tag">core</span></div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="invincibility-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Invincibility</h3>
                    <p>Golden shield + flash on spawn/damage.</p>
                    <div class="controls">
                        <div class="control-row"><label>Duration</label><input type="range" id="invuln-dur" min="30" max="180" value="120"><span class="value">2s</span></div>
                    </div>
                    <div class="asset-meta"><span class="tag">defensive</span></div>
                </div>
            </div>
            <div class="asset-card">
                <div class="asset-preview"><canvas id="difficulty-canvas" width="200" height="150"></canvas></div>
                <div class="asset-info">
                    <h3>Difficulty Scaling</h3>
                    <p>Speed and enemy count scale with score.</p>
                    <div class="asset-meta"><span class="tag">progression</span></div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" id="audio">
        <h2>üîä Audio</h2>
        <div class="asset-grid">
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">ü´ß</div>
                    <button onclick="Audio.playBloop()" class="audio-btn">‚ñ∂ Bloop</button>
                </div>
                <div class="asset-info"><h3>Bubble Collect</h3><p>Rising pitch sweep.</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">üí•</div>
                    <button onclick="Audio.playHit()" class="audio-btn">‚ñ∂ Hit</button>
                </div>
                <div class="asset-info"><h3>Damage</h3><p>Sawtooth descend.</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">üíÄ</div>
                    <button onclick="Audio.playDeath()" class="audio-btn">‚ñ∂ Death</button>
                </div>
                <div class="asset-info"><h3>Game Over</h3><p>Dramatic descend.</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">‚ù§Ô∏è</div>
                    <button onclick="Audio.playExtraLife()" class="audio-btn">‚ñ∂ Life</button>
                </div>
                <div class="asset-info"><h3>Extra Life</h3><p>Ascending arpeggio.</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">ü™ù</div>
                    <button onclick="Audio.playHooked()" class="audio-btn">‚ñ∂ Hooked</button>
                </div>
                <div class="asset-info"><h3>Hooked</h3><p>Triangle sweep down.</p></div>
            </div>
            <div class="asset-card">
                <div class="asset-preview" style="flex-direction: column; gap: 10px;">
                    <div style="font-size: 48px;">‚¨ÜÔ∏è</div>
                    <button onclick="Audio.playLevelUp()" class="audio-btn">‚ñ∂ Level Up</button>
                </div>
                <div class="asset-info"><h3>Level Up</h3><p>Triumphant arpeggio.</p></div>
            </div>
            <div class="asset-card" style="grid-column: span 2;">
                <div class="asset-preview" style="flex-direction: column; gap: 10px; height: auto; padding: 20px;">
                    <div style="font-size: 36px;">üéµ Music Tracks</div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                        <div class="music-track" style="text-align:center;padding:10px;background:#001020;border-radius:8px;">
                            <div style="color: #4488ff;">üåä Ocean</div>
                            <audio controls src="../assets/music/music_ocean.mp3" style="width: 150px; height: 30px;"></audio>
                        </div>
                        <div class="music-track" style="text-align:center;padding:10px;background:#001020;border-radius:8px;">
                            <div style="color: #88ffff;">üêü Tank</div>
                            <audio controls src="../assets/music/music_tank.mp3" style="width: 150px; height: 30px;"></audio>
                        </div>
                        <div class="music-track" style="text-align:center;padding:10px;background:#001020;border-radius:8px;">
                            <div style="color: #ff8844;">üç≥ Kitchen</div>
                            <audio controls src="../assets/music/music_kitchen.mp3" style="width: 150px; height: 30px;"></audio>
                        </div>
                    </div>
                </div>
                <div class="asset-info"><h3>Level Music</h3><p>Transport Tycoon style ragtime.</p></div>
            </div>
        </div>
    </section>
    <div id="bottom-nav"><a href="/" class="game">ü¶û Play</a></div>
    <div id="toast"></div>
    
    <script src="../js/audio.js"></script>
    <script type="module">
        import { render as lobsterV001 } from '../js/entities/hero/versions/Lobster.v001.js';
        import { render as lobsterV002 } from '../js/entities/hero/versions/Lobster.v002.js';
        import { render as lobsterV003 } from '../js/entities/hero/versions/Lobster.v003.js';
        import { render as fishV001 } from '../js/entities/pickups/versions/GoldenFish.v001.js';
        import { render as fishV002 } from '../js/entities/pickups/versions/GoldenFish.v002.js';
        import { render as bubbleV001 } from '../js/entities/pickups/versions/Bubble.v001.js';
        import { render as bubbleV002 } from '../js/entities/pickups/versions/Bubble.v002.js';
        import { render as hookV001 } from '../js/entities/enemies/versions/Hook.v001.js';
        import { render as hookV002 } from '../js/entities/enemies/versions/Hook.v002.js';
        import { render as cageV001 } from '../js/entities/enemies/versions/Cage.v001.js';
        import { render as cageV002 } from '../js/entities/enemies/versions/Cage.v002.js';
        import { renderOceanPreview } from '../js/entities/environments/Ocean.js';
        import { renderTankPreview } from '../js/entities/environments/Tank.js';
        import { renderKitchenPreview } from '../js/entities/environments/Kitchen.js';
        
        const renderers = {
            'lobster-001': (c,x,y,s,t) => lobsterV001(c,x,y,s),
            'lobster-002': (c,x,y,s,t) => lobsterV002(c,x,y,s),
            'lobster-003': (c,x,y,s,t) => lobsterV003(c,x,y,s,t),
            'fish-001': (c,x,y,t) => fishV001(c,x,y,15,1),
            'fish-002': (c,x,y,t) => fishV002(c,x,y,t,15,1,5),
            'bubble-001': (c,x,y,s,t) => bubbleV001(c,x,y,s,false),
            'bubble-002': (c,x,y,s,t) => bubbleV002(c,x,y,s,t),
            'hook-001': (c,x,l,t) => hookV001(c,x,l),
            'hook-002': (c,x,l,t) => hookV002(c,x,l,t,10),
            'cage-001': (c,x,y,s) => cageV001(c,x,y,s),
            'cage-002': (c,x,y,s) => cageV002(c,x,y,s),
        };
        
        // Net and Fork renderers
        function renderNet(ctx, x, y, width) {
            ctx.strokeStyle = "#446688"; ctx.lineWidth = 2;
            for (let r = 0; r <= 4; r++) { ctx.beginPath(); ctx.moveTo(x-width/2, y-30+r*15); ctx.lineTo(x+width/2, y-30+r*15); ctx.stroke(); }
            for (let c = 0; c <= 5; c++) { ctx.beginPath(); ctx.moveTo(x-width/2+c*(width/5), y-30); ctx.lineTo(x-width/2+c*(width/5), y+30); ctx.stroke(); }
            ctx.strokeStyle = "#886644"; ctx.lineWidth = 4;
            ctx.beginPath(); ctx.moveTo(x, y-30); ctx.lineTo(x, y-60); ctx.stroke();
        }
        function renderFork(ctx, x, y, size) {
            ctx.fillStyle = "#8B4513"; ctx.fillRect(x-4, y-50, 8, 50);
            ctx.fillStyle = "#c0c0c0";
            for (let i = -1; i <= 1; i++) {
                ctx.beginPath(); ctx.moveTo(x+i*10-3, y); ctx.lineTo(x+i*10+3, y); ctx.lineTo(x+i*10+1, y+35); ctx.lineTo(x+i*10-1, y+35); ctx.closePath(); ctx.fill();
            }
        }
        // Mechanics renderers
        function renderMagnetDemo(ctx, w, h, t, radius = 80, strength = 3) {
            ctx.fillStyle = "#000810"; ctx.fillRect(0,0,w,h);
            const cx = w/2, cy = h/2;
            ctx.strokeStyle = "rgba(100,200,255,0.3)"; ctx.setLineDash([5,5]);
            ctx.beginPath(); ctx.arc(cx, cy, radius * 0.75, 0, Math.PI*2); ctx.stroke();
            ctx.setLineDash([]);
            for (let i = 0; i < 5; i++) {
                const angle = t * 0.02 + i * (Math.PI * 2 / 5);
                const dist = (radius * 0.6) + Math.sin(t * 0.02 * strength + i) * 15;
                const bx = cx + Math.cos(angle) * dist;
                const by = cy + Math.sin(angle) * dist;
                ctx.fillStyle = "rgba(100,180,255,0.6)";
                ctx.beginPath(); ctx.arc(bx, by, 8, 0, Math.PI*2); ctx.fill();
                ctx.strokeStyle = "rgba(100,200,255,0.2)";
                ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(bx,by); ctx.stroke();
            }
            ctx.fillStyle = "#ff4500"; ctx.beginPath(); ctx.arc(cx, cy, 12, 0, Math.PI*2); ctx.fill();
        }
        function renderInvincibilityDemo(ctx, w, h, t, dur = 120) {
            ctx.fillStyle = "#000810"; ctx.fillRect(0,0,w,h);
            const cx = w/2, cy = h/2;
            const flash = Math.floor(t / 5) % 2;
            ctx.globalAlpha = flash ? 1 : 0.4;
            ctx.fillStyle = "#ff4500"; ctx.beginPath(); ctx.ellipse(cx, cy, 25, 15, 0, 0, Math.PI*2); ctx.fill();
            ctx.globalAlpha = 1;
            ctx.strokeStyle = "#ffff0066"; ctx.lineWidth = 3;
            const pulse = 1 + Math.sin(t * 0.1) * 0.1;
            ctx.beginPath(); ctx.arc(cx, cy, 35 * pulse, 0, Math.PI*2); ctx.stroke();
            ctx.lineWidth = 1;
        }
        function renderDifficultyGraph(ctx, w, h) {
            ctx.fillStyle = "#000810"; ctx.fillRect(0,0,w,h);
            ctx.strokeStyle = "#444"; ctx.lineWidth = 1;
            ctx.beginPath(); ctx.moveTo(30,20); ctx.lineTo(30,h-20); ctx.lineTo(w-20,h-20); ctx.stroke();
            ctx.fillStyle = "#666"; ctx.font = "10px monospace";
            ctx.fillText("diff", 35, 25); ctx.fillText("score", w-45, h-8);
            ctx.strokeStyle = "#ff4500"; ctx.lineWidth = 2;
            ctx.beginPath(); ctx.moveTo(30, h-25);
            const pts = [[0,1],[100,1.2],[200,1.4],[500,1.6],[1000,2]];
            pts.forEach(p => { const x = 30 + (p[0]/1000)*(w-50); const y = h-25-(p[1]-1)*(h-50); ctx.lineTo(x,y); });
            ctx.stroke();
        }
        
        let frame = 0, compareItems = [], params = {
            lobsterSize: 30, lobsterWag: 8,
            fishShimmer: 5,
            hookSwing: 10, hookLine: 100,
            cageSize: 50, netWidth: 80, forkSize: 40,
            bubbleSize: 18,
            magnetRadius: 80, magnetStrength: 3,
            invulnDur: 120
        };
        const canvases = {};
        ['lobster','fish','hook','cage','bubble'].forEach(id => canvases[id] = document.getElementById(id+'-canvas'));
        canvases.ocean = document.getElementById('ocean-bg');
        canvases.tank = document.getElementById('tank-bg');
        canvases.kitchen = document.getElementById('kitchen-bg');
        canvases.magnet = document.getElementById('magnet-canvas');
        canvases.invincibility = document.getElementById('invincibility-canvas');
        canvases.difficulty = document.getElementById('difficulty-canvas');
        canvases.net = document.getElementById('net-canvas');
        canvases.fork = document.getElementById('fork-canvas');
        
        function animate() {
            frame++;
            const c = (id) => canvases[id]?.getContext('2d');
            Object.values(canvases).forEach(cv => cv?.getContext('2d').clearRect(0,0,200,150));
            
            if(c('lobster')) lobsterV003(c('lobster'), 100, 80, params.lobsterSize, frame, params.lobsterWag);
            if(c('fish')) fishV002(c('fish'), 100, 75, frame, 15, 1, params.fishShimmer);
            if(c('hook')) hookV002(c('hook'), 100, 100, frame, 10);
            if(c('cage')) cageV002(c('cage'), 100, 75, 50);
            if(c('net')) renderNet(c('net'), 100, 75, 80);
            if(c('fork')) renderFork(c('fork'), 100, 70, 40);
            //ENEMIES(c('cage'), 100, 75, 50);
            if(c('bubble')) bubbleV001(c('bubble'), 100, 75, 18, false);
            if(c('ocean')) renderOceanPreview(c('ocean'), 200, 150, frame);
            if(c('tank')) renderTankPreview(c('tank'), 200, 150);
            if(c('kitchen')) renderKitchenPreview(c('kitchen'), 200, 150, frame);
            if(c('magnet')) renderMagnetDemo(c('magnet'), 200, 150, frame);
            if(c('invincibility')) renderInvincibilityDemo(c('invincibility'), 200, 150, frame);
            if(c('difficulty')) renderDifficultyGraph(c('difficulty'), 200, 150);
            // END MECHANICS(c('kitchen'), 200, 150, frame);
            
            compareItems.forEach((item, i) => {
                const cv = document.getElementById(`compare-canvas-${i}`);
                if (!cv) return;
                const ctx = cv.getContext('2d');
                ctx.clearRect(0,0,180,120);
                ctx.fillStyle = '#000810'; ctx.fillRect(0,0,180,120);
                const r = renderers[item.key];
                if (r) {
                    if (item.key.includes('lobster')) r(ctx, 90, 60, 25, frame);
                    else if (item.key.includes('fish')) r(ctx, 90, 60, frame);
                    else if (item.key.includes('hook')) r(ctx, 90, 80, frame);
                    else if (item.key.includes('cage')) r(ctx, 90, 60, 50);
                    else if (item.key.includes('bubble')) r(ctx, 90, 60, 18, frame);
                }
            });
            requestAnimationFrame(animate);
        }
        
        window.clearComparison = () => { compareItems = []; updatePanel(); };
        function toggleCompare(asset, version, desc) {
            const key = `${asset}-${version}`;
            const idx = compareItems.findIndex(i => i.key === key);
            if (idx >= 0) { compareItems.splice(idx, 1); toast(`Removed ${key}`); }
            else { if (compareItems.length >= 4) { toast('Max 4'); return; } compareItems.push({key,asset,version,desc}); toast(`Added ${key}`); }
            updatePanel();
        }
        function updatePanel() {
            const panel = document.getElementById('compare-panel');
            const grid = document.getElementById('compare-grid');
            if (!compareItems.length) { panel.classList.remove('active'); return; }
            panel.classList.add('active');
            grid.innerHTML = compareItems.map((item,i) => `<div class="compare-item"><canvas id="compare-canvas-${i}" width="180" height="120"></canvas><div class="label">${item.asset} v${item.version}</div><div class="desc">${item.desc}</div></div>`).join('');
document.querySelectorAll('.version').forEach(t => t.classList.toggle('in-compare', compareItems.some(i => i.key === `${t.dataset.asset}-${t.dataset.version}`)));
        }
        function toast(m) { const t = document.getElementById('toast'); t.textContent = m; t.classList.add('show'); setTimeout(() => t.classList.remove('show'), 2000); }
        
        document.querySelectorAll('.version').forEach(t => t.addEventListener('click', () => toggleCompare(t.dataset.asset, t.dataset.version, t.dataset.desc)));
        document.querySelectorAll('.nav a').forEach(a => a.addEventListener('click', e => {
            e.preventDefault();
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(a.getAttribute('href').slice(1)).classList.add('active');
            document.querySelectorAll('.nav a').forEach(x => x.classList.remove('active'));
            a.classList.add('active');
        }));
        document.getElementById('lobster-size')?.addEventListener('input', e => { params.lobsterSize = +e.target.value; e.target.nextElementSibling.textContent = e.target.value; });
        
        animate();
    </script>
</body>
</html>
